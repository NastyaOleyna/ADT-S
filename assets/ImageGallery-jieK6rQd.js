import{_ as w,B as H,i as k,l as p,u as C,c as o,a as S,k as h,F as L,e as M,C as d,D as B,j as m,w as c,n as f,r as I,q as T,o as r,p as X,d as g,t as v}from"./index-BTUK8q38.js";import{e as A,h as _}from"./storyblok-D2HStyFq.js";const b={name:"ImageGallery",components:{ButtonBase:H},props:{name:String,slug:{type:String,required:!0},location:String,date:String,images:{type:Array,required:!0},repeatCount:{type:Number,required:!0},isActive:{type:Boolean,default:!1},imageHeight:{type:String,default:"230rem"},imageWidth:{type:String,default:"auto"},imageQuality:{type:Number,default:85},imageFormat:{type:String,default:null},resolutionRatio:{type:Number,default:1,validator:e=>e>0}},data(){return{isScrolling:!1,scrollTimeout:null,scrollStartX:0,isHovering:!1}},setup(){const e=C(),i=p();return{router:e,route:i}},methods:{navigateToShow(){!this.isActive&&!this.isScrolling&&k.navigateTo(this.router,`/shows/${this.slug}`)},handleGalleryClick(){this.navigateToShow()},handleScrollStart(e){this.isActive||(this.scrollStartX=e.touches?e.touches[0].clientX:e.clientX,this.isScrolling=!1)},handleScrollMove(e){if(this.isActive||!this.scrollStartX)return;const i=e.touches?e.touches[0].clientX:e.clientX;Math.abs(i-this.scrollStartX)>5&&(this.isScrolling=!0)},handleScrollEnd(){this.isActive||(clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.isScrolling=!1,this.scrollStartX=0},100))},customizeImageParams(e={}){let i;if(this.imageHeight.includes("vh")){const l=parseFloat(this.imageHeight);i=Math.round(l/100*window.innerHeight)}else if(this.imageHeight.includes("rem")){const l=parseFloat(getComputedStyle(document.documentElement).fontSize);i=parseFloat(this.imageHeight)*l}else i=parseInt(this.imageHeight)||100;let t=this.imageWidth!=="auto"&&parseInt(this.imageWidth)||0;const u=Math.round(i*this.resolutionRatio),s=t?Math.round(t*this.resolutionRatio):0,a=_({width:s,height:u,quality:this.imageQuality,resolutionRatio:this.resolutionRatio});return{width:a.width,height:a.height,quality:a.quality,format:this.imageFormat,...e}}},computed:{processedImages(){if(!this.images||!Array.isArray(this.images)||this.images.length===0)return[];const e=this.images.map((t,u)=>{if(!t||!t.url)return{url:"",alt:"Missing image"};const s=this.customizeImageParams();return{url:A(t.url,s),alt:t.alt||"Image"}}),i=[];for(let t=0;t<this.repeatCount;t++)i.push(...e);return i},imageStyle(){return{height:this.imageHeight,width:this.imageWidth!=="auto"?this.imageWidth:"auto"}},galleryContainerStyle(){return{height:this.imageHeight,minHeight:this.imageHeight}},galleryItemStyle(){return this.imageWidth!=="auto"?{width:this.imageWidth}:{}},shouldShowTags(){return this.name&&this.name.trim()||this.location&&this.location.trim()||this.date&&this.date.trim()}},mounted(){const e=this.$refs.gallery;e&&(e.addEventListener("mousedown",this.handleScrollStart),e.addEventListener("mousemove",this.handleScrollMove),e.addEventListener("mouseup",this.handleScrollEnd),e.addEventListener("mouseleave",this.handleScrollEnd),e.addEventListener("touchstart",this.handleScrollStart),e.addEventListener("touchmove",this.handleScrollMove),e.addEventListener("touchend",this.handleScrollEnd))},beforeUnmount(){const e=this.$refs.gallery;e&&(e.removeEventListener("mousedown",this.handleScrollStart),e.removeEventListener("mousemove",this.handleScrollMove),e.removeEventListener("mouseup",this.handleScrollEnd),e.removeEventListener("mouseleave",this.handleScrollEnd),e.removeEventListener("touchstart",this.handleScrollStart),e.removeEventListener("touchmove",this.handleScrollMove),e.removeEventListener("touchend",this.handleScrollEnd)),clearTimeout(this.scrollTimeout)}},W=["alt","data-index"];function x(e,i,t,u,s,a){const l=I("ButtonBase"),E=T("lazy-load");return r(),o("div",{class:f(["gallery-container",{clickable:!t.isActive}])},[S("div",{class:"gallery",ref:"gallery",style:d(a.galleryContainerStyle),onClick:i[0]||(i[0]=(...n)=>a.handleGalleryClick&&a.handleGalleryClick(...n)),onMouseenter:i[1]||(i[1]=n=>s.isHovering=!t.isActive),onMouseleave:i[2]||(i[2]=n=>s.isHovering=!1)},[(r(!0),o(L,null,M(a.processedImages,(n,y)=>(r(),o("div",{key:y,class:"gallery-item",style:d(a.galleryItemStyle)},[X(S("img",{alt:n.alt,style:d(a.imageStyle),"data-index":y,class:"gallery-image"},null,12,W),[[E,{url:n.url,threshold:.1,rootMargin:"100px"}]])],4))),128))],36),a.shouldShowTags?(r(),o("div",{key:0,class:"gallery-tags",onClick:i[3]||(i[3]=B(()=>{},["stop"]))},[t.name&&t.name.trim().length>0?(r(),m(l,{key:0,to:`/shows/${t.slug}`,variant:t.isActive?"active":"black",class:f({"button-hover":s.isHovering})},{default:c(()=>[g(v(t.name),1)]),_:1},8,["to","variant","class"])):h("",!0),t.location&&t.location.trim().length>0?(r(),m(l,{key:1,variant:"grey"},{default:c(()=>[g(v(t.location),1)]),_:1})):h("",!0),t.date&&t.date.trim().length>0?(r(),m(l,{key:2,variant:"grey"},{default:c(()=>[g(v(t.date),1)]),_:1})):h("",!0)])):h("",!0)],2)}const q=w(b,[["render",x]]);export{q as I};
