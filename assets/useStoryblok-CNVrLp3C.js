import{f as r,h as b,l as j,z as I,u as R,i as v}from"./index-BTUK8q38.js";import{p as k,l as h,c as C,b as M,a as P,f as W,d as x,g as z}from"./storyblok-D2HStyFq.js";function L(y={}){const{type:t="project",preload:w=!0,watchRoute:S=!0,routeParam:c="slug",onError:p=null}=y,u=j(),i=R(),n=r(null),$=r([]),f=r(!0),d=r(!1),l=r(""),m=async a=>{f.value=!0,d.value=!1,l.value="";const e=`${t}s/${a}`,s=await x(e);if(s.status==="success")n.value=s.data;else{l.value=`Could not load ${t} "${a}"`;const o=z();o?(n.value=o.data,l.value=`${t} "${a}" could not be loaded. Showing "${o.slug}" instead.`,setTimeout(()=>{i.replace(`/${t}s/${o.slug}`)},5e3)):p?p(s.error,a):setTimeout(()=>{v.navigateTo(i,`/${t}s`)},5e3)}await g(a),d.value=!0,setTimeout(()=>{f.value=!1},300)},g=async a=>{const e=await h({startsWith:`${t}s/`});e.status==="success"&&($.value=e.data.filter(s=>s.slug.split("/").pop()!==a))},T=a=>{v.navigateTo(i,`/${t}s/${a}`)};return b(async()=>{w&&(t==="project"?await k():await h({startsWith:`${t}s/`})),u.params[c]&&await m(u.params[c])}),S&&I(()=>u.params[c],(a,e)=>{a&&a!==e&&(m(a),window.scrollTo(0,0))}),{story:n,stories:$,isLoading:f,contentReady:d,errorMessage:l,loadStory:m,loadOtherStories:g,navigateTo:T,formatImage:W,formatImages:P,clearCache:M,cache:C}}export{L as u};
